#! /bin/bash

readonly ARGS="$*"
readonly ARGA=("$@")

_usage() {
  cat <<- EOF
  This is the usage
EOF
}

main () {

  if [[ -z "$ARGS" || "$ARGS" =~ --help$|-h$ ]]; then
    _usage;
    return 0;
  fi

  straceopened ${ARGA[*]} \
    | sed -n \
    -e 's_app/code/local/\([^/]*/[^/]*\)/.*_\1_p' \
    -e 's_app/code/community/\([^/]*/[^/]*\)/.*_\1_p' \
    -e 's_wp-content/plugins/\([^/]*\)/.*_\1_p' \
    | sort \
    | uniq -c \
    | sort -hr


}

main;
