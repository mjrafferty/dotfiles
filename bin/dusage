#! /bin/bash

readonly ARGS="$*"
readonly ARGA=("$@")


_files () {

  printf "\n----- Large Files ------\n";

  find . \
    -mindepth 1 \
    -size +100M \
    -group "$(getusr)" \
    -exec parallel du -sh -- {} + | sort -hr | head -20

}

_directories () {

  printf "\n----- Large Directories ------\n";

  find . \
    -mindepth 1 \
    -maxdepth 4 \
    -path ./var/mail -prune -o \
    -type d \
    -group "$(getusr)" \
    -exec parallel du -sh -- {} + | sort -hr | head -20

}

_mailboxes () {

  printf "\n----- Large Mailboxes ------\n";

  cd var || return 1;

  find ./*/mail/* \
    -maxdepth 0 \
    -type d \
    -group "$(getusr)"\
    -exec parallel du -sh -- {} + | sort -hr | head -10
}

main () {

  local files directories mailboxes;

  export -f _files;
  export -f _directories;
  export -f _mailboxes;

  cd /home/"$(getusr)" || return;

  parallel -- \
    files="$(_files)" \
    directories="$(_directories)" \
    mailboxes="$(_mailboxes)";

	printf "%s\n\n%s\n\n%s\n" "$files" "$directories" "$mailboxes";

}

main;
