#! /bin/bash

count="$(( $(ps -Chttpd | wc -l ) -1 ))";
max="$(sed -n 's/^MaxClients\s*\([0-9]*\).*/\1/p' /etc/httpd/conf/httpd.conf | head -n1)";

if [ "$count" -ge "$max" ]; then
  echo "Apache at MaxClients";
elif [ $count -ge "$(( 9 * max / 10 ))" ]; then
  echo "Apache near MaxClients";
fi
