#! /bin/bash

readonly ARGS="$*"
readonly ARGA=("$@")

_usage() {
  cat <<- EOF
  This is the usage
EOF
}

main () {

  (printf "Destination\tPort"
  grep -Poh 'connect\(.*sin_port=htons\(\K.*inet_addr\("[^"]*' "${ARGA[*]}"\
    | sed -n '/127.0.0.1/b; s/\([0-9]*\)[^0-9]*\([0-9,\.]*\)/\2\t\1/p' \
    | sort -u) \
    | column -t;

}

main;
