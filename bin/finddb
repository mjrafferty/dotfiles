#! /bin/bash

## find configuration file, and echo configured db name

if [[ -z "$1" ]]; then sitepath="."; else sitepath="$1"; fi;
	if [[ -f $sitepath/app/etc/local.xml ]]; then	# if site is mage
		echo $(grep dbname $sitepath/app/etc/local.xml | cut -d\[ -f3 | cut -d\] -f1)
	elif [[ -f $sitepath/wp-config.php ]]; then		# if site is wp
		echo $(grep db_name $sitepath/wp-config.php | cut -d\' -f4)
	elif [[ -f $sitepath/configuration.php ]]; then	# if site is joomla
		echo $(grep '$db ' $sitepath/configuration.php | cut -d\' -f2)
	elif [[ -f $sitepath/sugar_version.php ]]; then	# if site is surgarcrm
		echo $(grep db_name $sitepath/config.php | cut -d\' -f4)
	elif [[ -f $sitepath/includes/config.php ]]; then	# if site is vbulletin 4.x
		echo $(grep dbname $sitepath/includes/config.php | cut -d\' -f6)
	elif [[ -f $sitepath/upload/core/includes/config.php ]]; then	# if site is vbulletin 5.x
		echo $(grep dbname $sitepath/upload/core/includes/config.php | cut -d\' -f6)
	elif [[ "$1" == "ee" || "$1" == "ee" ]]; then	# if site is ee or another codeigniter app
		if [[ -z "$2" ]]; then sitepath="/home/$(getusr)"; else sitepath="$2"; fi
		config=$(find $sitepath -type f -name database.php -print)
		echo $(grep \'database\' $config | cut -d\' -f6)
	else # if there is no config to be found ...
		echo "${red}could not find configuration file!${normal}"; fi
		# done .. that was a lot of work!
