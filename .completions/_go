#compdef go

_listDest () {
  sqlite3 ~/.domain_cache "select domain from locations;"
  sqlite3 ~/.domain_cache "select destination from locations;"
  sqlite3 ~/.domain_cache "select ticket_id from tickets;"
}

_go() {

  local curcontext="$curcontext" state

  _arguments -C \
    '*: :->args'

  if [[ "$state" == "args" ]]; then
    _arguments \
      '*:Destination:($(_listDest))'
  fi
}
compdef _go go
